// Generated by CoffeeScript 1.6.1
(function() {
  'use strict';
  var directives;

  directives = angular.module('siteworx-body-js.directives', []);

  window.utf8_to_b64 = function(str) {
    return window.btoa(unescape(encodeURIComponent(str)));
  };

  window.b64_to_utf8 = function(str) {
    return decodeURIComponent(escape(window.atob(str)));
  };

  directives.directive('siteworxBodyJs', function($compile, $location) {
    return {
      restrict: 'E',
      scope: true,
      compile: function(element, attrs, transinclude) {
        return {
          pre: function(scope, element, attrs, controller) {},
          post: function(scope, element, attrs, controller) {
            return scope.$watch('cmsScriptsBody', function(val) {
              var decoded;
              if (val) {
                decoded = decodeURIComponent(escape(window.atob(val[0])));
                console.log("cmsScriptsBody", decoded);
                element.html(decoded);
                return $compile(element.contents())(scope);
              }
            });
            /*
            scope.$watch element, (val) ->
              if val
                #decoded = decodeURIComponent(escape(window.atob( val)))
                console.log "SITEWORXJS"
                #element.html(decoded)
                $compile(element.contents())(scope)
            */

          }
        };
      }
    };
  });

}).call(this);
